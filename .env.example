# ============================================================================
# OpenClaw Crypto Infrastructure - Environment Configuration
# ============================================================================
#
# This file contains configuration for the crypto analytics MCP server.
# Copy this to `.env` and fill in your API keys.
#
# ðŸ’¡ TIP: Most services have FREE tiers! See CLAUDE.md for cost optimization.
# ============================================================================

# ----------------------------------------------------------------------------
# ðŸ†“ FREE TIER SERVICES (No cost, instant start)
# ----------------------------------------------------------------------------

# === Crypto Prices ===
# CoinGecko Demo API - 30 calls/min, 10k/month, NO KEY REQUIRED
# Just use the public endpoint (no key needed)
COINGECKO_API_URL=https://api.coingecko.com/api/v3
COINGECKO_API_KEY=  # Leave empty for free tier

# CoinCap API - Unlimited, NO KEY REQUIRED
COINCAP_API_URL=https://api.coincap.io/v2

# === DeFi Data ===
# DeFiLlama - UNLIMITED, NO KEY REQUIRED ðŸŽ‰
DEFILLAMA_BASE_URL=https://api.llama.fi
DEFILLAMA_YIELDS_URL=https://yields.llama.fi
# No key needed!

# === Market Sentiment ===
# Fear & Greed Index - NO KEY REQUIRED
FEAR_GREED_API_URL=https://api.alternative.me/fng

# === Blockchain RPC Endpoints (Public, No Key) ===
# Grove/PublicNode - NO RATE LIMITS, NO KEY
ETH_RPC_URL=https://ethereum-rpc.publicnode.com
BASE_RPC_URL=https://base-rpc.publicnode.com
ARBITRUM_RPC_URL=https://arbitrum-one-rpc.publicnode.com
POLYGON_RPC_URL=https://polygon-bor-rpc.publicnode.com
OPTIMISM_RPC_URL=https://optimism-rpc.publicnode.com
BSC_RPC_URL=https://bsc-rpc.publicnode.com

# === Blockchain Explorers (Free tier: 100k calls/day) ===
# Sign up at etherscan.io/myapikey for instant free key
ETHERSCAN_API_KEY=YourFreeEtherscanKey
ETHERSCAN_API_URL=https://api.etherscan.io/api

# Sign up at arbiscan.io/myapikey
ARBISCAN_API_KEY=YourFreeArbiscanKey
ARBISCAN_API_URL=https://api.arbiscan.io/api

# Sign up at basescan.org/myapikey
BASESCAN_API_KEY=YourFreeBasescanKey
BASESCAN_API_URL=https://api.basescan.org/api

# ----------------------------------------------------------------------------
# ðŸ’³ PAID TIER SERVICES (Optional upgrades for higher limits)
# ----------------------------------------------------------------------------

# === CoinGecko Pro (Optional) ===
# Analyst Plan: $129/mo - 500 calls/min, 500k/month
# Only needed if hitting free tier limits
# COINGECKO_PRO_API_KEY=your_pro_key_here

# === CoinAPI (Optional) ===
# Startup Plan: $79/mo - 100k calls/month, 400+ exchanges
# MCP-compatible, historical OHLCV data
# COINAPI_KEY=your_coinapi_key
# COINAPI_BASE_URL=https://rest.coinapi.io

# === Nansen (Optional - Enterprise pricing) ===
# Smart money tracking, labeled wallets
# Required for advanced on-chain intelligence
# NANSEN_API_KEY=your_nansen_key
# NANSEN_API_URL=https://api.nansen.ai

# === Zerion (Optional) ===
# Standard Plan: $299/mo - Multi-chain portfolio data (38+ chains)
# ZERION_API_KEY=your_zerion_key
# ZERION_API_URL=https://api.zerion.io

# === Amberdata (Optional - Enterprise pricing) ===
# AI-driven market intelligence
# AMBERDATA_API_KEY=your_amberdata_key
# AMBERDATA_API_URL=https://api.amberdata.io

# === Alchemy (Optional) ===
# Growth Plan: $49/mo - Better RPC reliability, webhooks
# ALCHEMY_ETH_KEY=your_alchemy_key
# ALCHEMY_ETH_URL=https://eth-mainnet.g.alchemy.com/v2/${ALCHEMY_ETH_KEY}
# ALCHEMY_BASE_URL=https://base-mainnet.g.alchemy.com/v2/${ALCHEMY_ETH_KEY}
# ALCHEMY_ARB_URL=https://arb-mainnet.g.alchemy.com/v2/${ALCHEMY_ETH_KEY}

# === QuickNode (Optional) ===
# Build Plan: $9/mo - Faster RPC, multiple chains
# QUICKNODE_ETH_URL=https://your-endpoint.quiknode.pro/your-key
# QUICKNODE_BASE_URL=https://your-base-endpoint.quiknode.pro/your-key

# === The Graph (Optional) ===
# Pay-per-query: ~$0.0001/query - Decentralized indexing
# THE_GRAPH_API_KEY=your_graph_key
# THE_GRAPH_URL=https://gateway.thegraph.com/api

# ----------------------------------------------------------------------------
# ðŸ”§ MCP SERVER CONFIGURATION
# ----------------------------------------------------------------------------

# === Server Settings ===
MCP_SERVER_HOST=0.0.0.0
MCP_SERVER_PORT=3000
MCP_SERVER_NAME=openclaw-crypto-mcp

# === Cache Configuration ===
# Redis (recommended for production)
REDIS_URL=redis://localhost:6379
# Or use in-memory cache (development)
USE_IN_MEMORY_CACHE=true

# === Cache TTL (Time To Live in seconds) ===
CACHE_TTL_PRICES=30          # 30 seconds - prices change frequently
CACHE_TTL_DEFI_YIELDS=300    # 5 minutes - yields relatively stable
CACHE_TTL_PROTOCOL_TVL=600   # 10 minutes - TVL updates slowly
CACHE_TTL_WALLET_BALANCE=120 # 2 minutes - balance changes moderately
CACHE_TTL_FEAR_GREED=3600    # 1 hour - updates once daily
CACHE_TTL_ONCHAIN=60         # 1 minute - blockchain data

# === Rate Limiting ===
# CoinGecko Free: 30 calls/min
RATE_LIMIT_COINGECKO_FREE=30
RATE_LIMIT_WINDOW_SECONDS=60

# Etherscan Free: 5 calls/sec
RATE_LIMIT_ETHERSCAN_FREE=5
RATE_LIMIT_ETHERSCAN_WINDOW_SECONDS=1

# === Error Handling ===
# Allow stale cache when rate limited (seconds)
STALE_CACHE_MAX_AGE=300  # 5 minutes

# === Logging ===
LOG_LEVEL=info  # debug, info, warning, error
LOG_FORMAT=json  # json or pretty

# === Monitoring (Optional) ===
# Sentry error tracking
# SENTRY_DSN=your_sentry_dsn

# Prometheus metrics
ENABLE_METRICS=true
METRICS_PORT=9090

# ----------------------------------------------------------------------------
# ðŸ“Š COST OPTIMIZATION SETTINGS
# ----------------------------------------------------------------------------

# === Aggressive Caching ===
# Enable aggressive caching to minimize API calls
AGGRESSIVE_CACHING=true

# === Batch Requests ===
# Maximum symbols per batch request
MAX_BATCH_SIZE=50  # CoinGecko supports up to 250

# === Fallback Strategy ===
# Primary source (coingecko, coincap, coinapi)
PRIMARY_PRICE_SOURCE=coingecko
# Fallback source
FALLBACK_PRICE_SOURCE=coincap

# === Usage Monitoring ===
# Alert when approaching rate limits
RATE_LIMIT_WARNING_THRESHOLD=0.8  # 80% of limit

# ----------------------------------------------------------------------------
# ðŸ”’ SECURITY
# ----------------------------------------------------------------------------

# JWT secret for authenticated endpoints (generate with: openssl rand -hex 32)
JWT_SECRET=your_secure_random_string_here

# Allowed origins for CORS (comma-separated)
ALLOWED_ORIGINS=http://localhost:8080,https://yourdomain.com

# API rate limiting (requests per minute per IP)
API_RATE_LIMIT=100

# ----------------------------------------------------------------------------
# ðŸš€ DEPLOYMENT
# ----------------------------------------------------------------------------

# Environment (development, staging, production)
NODE_ENV=development

# Health check endpoint
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_PATH=/health

# Graceful shutdown timeout (seconds)
SHUTDOWN_TIMEOUT=10

# ----------------------------------------------------------------------------
# ðŸ“ NOTES
# ----------------------------------------------------------------------------
#
# FREE TIER CAPACITY (with 30s caching, 80% hit rate):
# - ~21,600 users/day with CoinGecko free
# - Unlimited DeFi data via DeFiLlama
# - Unlimited on-chain reads via public RPC
# - 100,000 explorer calls/day per chain
#
# WHEN TO UPGRADE:
# - Hitting rate limits >3 times/day â†’ Consider CoinGecko Pro
# - Need historical data â†’ Add CoinAPI
# - Need smart money tracking â†’ Add Nansen
# - Need portfolio analytics â†’ Add Zerion
# - Generating revenue â†’ Invest in paid tiers
#
# COST ESTIMATES:
# - Level 0 (Free): $0/month - 10-50 users/day
# - Level 1 (Budget): $10-30/month - 100-500 users/day
# - Level 2 (Pro): $50-200/month - 1000+ users/day
#
# See CLAUDE.md for detailed cost optimization strategies.
# ----------------------------------------------------------------------------
